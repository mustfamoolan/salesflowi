import{r as c,j as e}from"./app-CuBlbhlW.js";import oe from"./BackButton-C7rP9mAK.js";/* empty css            */const xe=()=>{c.useEffect(()=>{setTimeout(()=>{const t=document.getElementById("loading-screen");t&&(t.style.display="none")},1e3)},[]);const[g,de]=c.useState(!0),[Q,$]=c.useState(!1),[h,T]=c.useState(null),[U,A]=c.useState(!1),[P,Y]=c.useState(""),[q,J]=c.useState("all"),[f,F]=c.useState([{id:1,customerName:"أحمد محمد العلي",customerId:1,totalAmount:3e6,paidAmount:1e6,remainingAmount:2e6,installmentAmount:5e5,frequency:"monthly",totalInstallments:6,paidInstallments:2,remainingInstallments:4,startDate:"2025-06-01",nextDueDate:"2025-08-01",status:"active",notes:"قسط شهري 500 ألف دينار",invoiceNumber:"INV-2025-001",installmentSchedule:[{id:1,dueDate:"2025-06-01",amount:5e5,paidAmount:5e5,status:"paid",paidDate:"2025-06-01",notes:"دفع في الموعد"},{id:2,dueDate:"2025-07-01",amount:5e5,paidAmount:5e5,status:"paid",paidDate:"2025-07-01",notes:"دفع في الموعد"},{id:3,dueDate:"2025-08-01",amount:5e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:4,dueDate:"2025-09-01",amount:5e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:5,dueDate:"2025-10-01",amount:5e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:6,dueDate:"2025-11-01",amount:5e5,paidAmount:0,status:"pending",paidDate:null,notes:""}]},{id:2,customerName:"فاطمة حسن الكريم",customerId:2,totalAmount:15e5,paidAmount:5e5,remainingAmount:1e6,installmentAmount:25e4,frequency:"biweekly",totalInstallments:6,paidInstallments:2,remainingInstallments:4,startDate:"2025-07-01",nextDueDate:"2025-08-15",status:"active",notes:"قسط كل أسبوعين",invoiceNumber:"INV-2025-003",installmentSchedule:[{id:1,dueDate:"2025-07-01",amount:25e4,paidAmount:25e4,status:"paid",paidDate:"2025-07-01",notes:"دفع نقدي"},{id:2,dueDate:"2025-07-15",amount:25e4,paidAmount:25e4,status:"paid",paidDate:"2025-07-16",notes:"تأخر يوم واحد"},{id:3,dueDate:"2025-08-01",amount:25e4,paidAmount:0,status:"overdue",paidDate:null,notes:"متأخر 5 أيام"},{id:4,dueDate:"2025-08-15",amount:25e4,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:5,dueDate:"2025-09-01",amount:25e4,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:6,dueDate:"2025-09-15",amount:25e4,paidAmount:0,status:"pending",paidDate:null,notes:""}]},{id:3,customerName:"محمد علي الربيعي",customerId:3,totalAmount:2e6,paidAmount:0,remainingAmount:2e6,installmentAmount:4e5,frequency:"monthly",totalInstallments:5,paidInstallments:0,remainingInstallments:5,startDate:"2025-08-01",nextDueDate:"2025-08-01",status:"active",notes:"تقسيط جديد",invoiceNumber:"INV-2025-005",installmentSchedule:[{id:1,dueDate:"2025-08-01",amount:4e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:2,dueDate:"2025-09-01",amount:4e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:3,dueDate:"2025-10-01",amount:4e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:4,dueDate:"2025-11-01",amount:4e5,paidAmount:0,status:"pending",paidDate:null,notes:""},{id:5,dueDate:"2025-12-01",amount:4e5,paidAmount:0,status:"pending",paidDate:null,notes:""}]}]),[s,u]=c.useState({customerId:"",customerName:"",totalAmount:0,downPayment:0,installmentAmount:0,frequency:"monthly",totalInstallments:1,calculationMethod:"by_amount",duration:1,startDate:"",notes:"",invoiceNumber:""}),[K]=c.useState([{id:1,name:"أحمد محمد العلي",phone:"07701234567"},{id:2,name:"فاطمة حسن الكريم",phone:"07709876543"},{id:3,name:"محمد علي الربيعي",phone:"07701112233"},{id:4,name:"سارة أحمد الكاظم",phone:"07705555666"},{id:5,name:"علي حسين الجابر",phone:"07708888999"}]),[O,B]=c.useState(""),[X,L]=c.useState(!1),[i,b]=c.useState({amount:0,method:"نقدي",notes:""}),[l,I]=c.useState(null),[Z,v]=c.useState(!1),R={ar:{title:"إدارة الأقساط",subtitle:"متابعة الأقساط والمدفوعات",search:"البحث عن قسط...",addInstallment:"إضافة تقسيط جديد",totalInstallments:"إجمالي الأقساط",activeInstallments:"أقساط نشطة",overdueInstallments:"أقساط متأخرة",completedInstallments:"أقساط مكتملة",filters:{all:"الكل",active:"نشط",overdue:"متأخر",completed:"مكتمل"},installmentInfo:{totalAmount:"المبلغ الإجمالي",remainingAmount:"المبلغ المتبقي",installmentAmount:"مبلغ القسط",frequency:"التردد",nextDue:"القسط القادم",progress:"التقدم"},frequency:{monthly:"شهري",biweekly:"كل أسبوعين",weekly:"أسبوعي"},status:{active:"نشط",completed:"مكتمل",overdue:"متأخر",pending:"معلق",paid:"مدفوع",partial:"جزئي"},actions:{view:"عرض التفاصيل",pay:"دفع قسط"},payment:{title:"دفع قسط",amount:"المبلغ",method:"طريقة الدفع",notes:"ملاحظات",save:"تسجيل الدفع",cancel:"إلغاء",dueAmount:"المبلغ المستحق",overpayment:"دفع إضافي",willDistribute:"سيتم توزيع المبلغ الإضافي على الأقساط التالية",partialPayment:"دفع جزئي",remainingForThisInstallment:"المتبقي لهذا القسط"},create:{title:"إنشاء تقسيط جديد",customer:"اختر العميل",customerSearch:"ابحث عن عميل...",totalAmount:"المبلغ الإجمالي",downPayment:"المبلغ المقدم (اختياري)",installmentAmount:"مبلغ القسط",frequency:"تردد الدفع",calculationMethod:"طريقة الحساب",byAmount:"تحديد مبلغ القسط",byDuration:"تحديد المدة",duration:"المدة",totalInstallments:"عدد الأقساط",startDate:"تاريخ البداية",notes:"ملاحظات",invoiceNumber:"رقم الفاتورة",autoGenerate:"توليد تلقائي",save:"حفظ",cancel:"إلغاء",months:"شهر",weeks:"أسبوع",remainingAmount:"المبلغ المتبقي للتقسيط"},schedule:{title:"جدول الأقساط",installmentNumber:"رقم القسط",dueDate:"تاريخ الاستحقاق",amount:"المبلغ",status:"الحالة",paidDate:"تاريخ الدفع"},currency:"د.ع",noInstallments:"لا يوجد أقساط",daysOverdue:"يوم تأخير"},en:{title:"Installments Management",subtitle:"Track installments and payments",search:"Search for installment...",addInstallment:"Add New Installment",totalInstallments:"Total Installments",activeInstallments:"Active Installments",overdueInstallments:"Overdue Installments",completedInstallments:"Completed Installments",filters:{all:"All",active:"Active",overdue:"Overdue",completed:"Completed"},installmentInfo:{totalAmount:"Total Amount",remainingAmount:"Remaining Amount",installmentAmount:"Installment Amount",frequency:"Frequency",nextDue:"Next Due",progress:"Progress"},frequency:{monthly:"Monthly",biweekly:"Bi-weekly",weekly:"Weekly"},status:{active:"Active",completed:"Completed",overdue:"Overdue",pending:"Pending",paid:"Paid",partial:"Partial"},actions:{view:"View Details",pay:"Pay Installment"},payment:{title:"Pay Installment",amount:"Amount",method:"Payment Method",notes:"Notes",save:"Record Payment",cancel:"Cancel",dueAmount:"Due Amount",overpayment:"Overpayment",willDistribute:"Extra amount will be distributed to next installments",partialPayment:"Partial Payment",remainingForThisInstallment:"Remaining for this installment"},create:{title:"Create New Installment",customer:"Select Customer",customerSearch:"Search for customer...",totalAmount:"Total Amount",downPayment:"Down Payment (Optional)",installmentAmount:"Installment Amount",frequency:"Payment Frequency",calculationMethod:"Calculation Method",byAmount:"Set Installment Amount",byDuration:"Set Duration",duration:"Duration",totalInstallments:"Number of Installments",startDate:"Start Date",notes:"Notes",invoiceNumber:"Invoice Number",autoGenerate:"Auto Generate",save:"Save",cancel:"Cancel",months:"months",weeks:"weeks",remainingAmount:"Remaining Amount for Installment"},schedule:{title:"Installment Schedule",installmentNumber:"Installment #",dueDate:"Due Date",amount:"Amount",status:"Status",paidDate:"Paid Date"},currency:"IQD",noInstallments:"No installments",daysOverdue:"days overdue"}},a=g?R.ar:R.en,m=t=>new Intl.NumberFormat(g?"ar-IQ":"en-US").format(t),_=t=>{switch(t){case"paid":case"completed":return"text-green-600";case"active":return"text-blue-600";case"overdue":return"text-red-600";case"pending":return"text-gray-600";case"partial":return"text-yellow-600";default:return"text-gray-600"}},E=t=>{switch(t){case"paid":case"completed":return"bg-green-100 border-green-200";case"active":return"bg-blue-100 border-blue-200";case"overdue":return"bg-red-100 border-red-200";case"pending":return"bg-gray-100 border-gray-200";case"partial":return"bg-yellow-100 border-yellow-200";default:return"bg-gray-100 border-gray-200"}},ee=t=>{const n=new Date,o=new Date(t),r=n-o,d=Math.ceil(r/(1e3*60*60*24));return d>0?d:0},W=t=>t.find(n=>n.status==="pending"||n.status==="overdue"),V=f.filter(t=>{const n=t.customerName.toLowerCase().includes(P.toLowerCase())||t.invoiceNumber.toLowerCase().includes(P.toLowerCase());return q==="all"?n:n&&t.status===q}),te=(t,n)=>{const o=f.map(r=>{if(r.id===t){const d=r.installmentSchedule.map(x=>x.id===n?{...x,status:"paid",paidDate:new Date().toISOString().split("T")[0],paidAmount:x.amount}:x),y=d.filter(x=>x.status==="paid").length,j=d.filter(x=>x.status==="paid").reduce((x,p)=>x+p.paidAmount,0),N=r.totalAmount-j;return{...r,installmentSchedule:d,paidInstallments:y,remainingInstallments:r.totalInstallments-y,paidAmount:j,remainingAmount:N,status:N<=0?"completed":"active"}}return r});F(o)},ae=t=>{if(!h||!l)return;const n=f.map(o=>{if(o.id===h.id){let r=t;const d=[...o.installmentSchedule],y=d.findIndex(p=>p.id===l.id);if(y!==-1){const p=d[y],k=p.paidAmount||0,G=p.amount-k;if(r>=G){d[y]={...p,paidAmount:p.amount,status:"paid",paidDate:new Date().toISOString().split("T")[0]},r-=G;for(let S=y+1;S<d.length&&r>0;S++){const w=d[S],C=w.paidAmount||0,H=w.amount-C;if(H>0){const M=Math.min(r,H);d[S]={...w,paidAmount:C+M,status:C+M>=w.amount?"paid":"partial",paidDate:C+M>=w.amount?new Date().toISOString().split("T")[0]:null},r-=M}}}else d[y]={...p,paidAmount:k+r,status:"partial",paidDate:null},r=0}const j=d.reduce((p,k)=>p+(k.paidAmount||0),0),N=o.totalAmount-j,x=d.filter(p=>p.status==="paid").length;return{...o,installmentSchedule:d,paidInstallments:x,remainingInstallments:o.totalInstallments-x,paidAmount:j,remainingAmount:N,status:N<=0?"completed":"active"}}return o});F(n),v(!1),b({amount:0,method:"نقدي",notes:""}),I(null)},se=async t=>{if(t.preventDefault(),!i.amount||i.amount<=0){alert("من فضلك ادخل مبلغ صحيح");return}try{await ae(h.id,l.id,i.amount,i.method,i.notes),b({amount:0,method:"نقدي",notes:""}),v(!1),I(null),alert("تم تسجيل الدفعة بنجاح")}catch(n){console.error("Error processing payment:",n),alert("حدث خطأ في تسجيل الدفعة")}},z=K.filter(t=>t.name.toLowerCase().includes(O.toLowerCase())),ne=t=>{u(n=>({...n,customerId:t.id,customerName:t.name})),B(t.name),L(!1)},le=()=>{const t=new Date,n=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),d=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`INST-${n}${o}${r}-${d}`},re=()=>{const t=s.totalAmount-s.downPayment;if(s.calculationMethod==="by_amount"&&s.installmentAmount>0){const n=Math.ceil(t/s.installmentAmount);u(o=>({...o,totalInstallments:n}))}else if(s.calculationMethod==="by_duration"&&s.duration>0){let n;s.frequency==="monthly"?n=s.duration:s.frequency==="biweekly"?n=s.duration*2:s.frequency==="weekly"&&(n=s.duration*4);const o=Math.ceil(t/n);u(r=>({...r,totalInstallments:n,installmentAmount:o}))}};c.useEffect(()=>{s.totalAmount>0&&re()},[s.totalAmount,s.downPayment,s.installmentAmount,s.duration,s.calculationMethod,s.frequency]);const D={total:f.length,active:f.filter(t=>t.status==="active").length,overdue:f.filter(t=>{const n=W(t.installmentSchedule);return n&&n.status==="overdue"}).length,completed:f.filter(t=>t.status==="completed").length};return e.jsxs("div",{className:`min-h-screen bg-gray-50 ${g?"rtl":"ltr"}`,children:[e.jsx(oe,{}),e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:a.title}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:a.subtitle})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:()=>A(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:a.addInstallment})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsxs("div",{className:`${g?"mr-3":"ml-3"} flex-1 min-w-0`,children:[e.jsx("p",{className:"text-blue-600 text-xs font-medium truncate",children:a.totalInstallments}),e.jsx("p",{className:"text-blue-900 text-lg font-bold",children:D.total})]})]})}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:e.jsx("span",{className:"text-white text-sm",children:"✅"})}),e.jsxs("div",{className:`${g?"mr-3":"ml-3"} flex-1 min-w-0`,children:[e.jsx("p",{className:"text-green-600 text-xs font-medium truncate",children:a.activeInstallments}),e.jsx("p",{className:"text-green-900 text-lg font-bold",children:D.active})]})]})}),e.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-500 rounded-lg",children:e.jsx("span",{className:"text-white text-sm",children:"🚨"})}),e.jsxs("div",{className:`${g?"mr-3":"ml-3"} flex-1 min-w-0`,children:[e.jsx("p",{className:"text-red-600 text-xs font-medium truncate",children:a.overdueInstallments}),e.jsx("p",{className:"text-red-900 text-lg font-bold",children:D.overdue})]})]})}),e.jsx("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-gray-500 rounded-lg",children:e.jsx("span",{className:"text-white text-sm",children:"✔️"})}),e.jsxs("div",{className:`${g?"mr-3":"ml-3"} flex-1 min-w-0`,children:[e.jsx("p",{className:"text-gray-600 text-xs font-medium truncate",children:a.completedInstallments}),e.jsx("p",{className:"text-gray-900 text-lg font-bold",children:D.completed})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",placeholder:a.search,value:P,onChange:t=>Y(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("svg",{className:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:q,onChange:t=>J(t.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:a.filters.all}),e.jsx("option",{value:"active",children:a.filters.active}),e.jsx("option",{value:"overdue",children:a.filters.overdue}),e.jsx("option",{value:"completed",children:a.filters.completed})]})]})]})}),e.jsx("div",{className:"p-4",children:V.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:a.noInstallments})]}):e.jsx("div",{className:"space-y-4",children:V.map(t=>{const n=W(t.installmentSchedule),o=t.paidInstallments/t.totalInstallments*100;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold ${t.status==="completed"?"bg-green-500":t.status==="active"?"bg-blue-500":"bg-gray-500"}`,children:t.status==="completed"?"✔️":"📋"}),e.jsxs("div",{className:`${g?"mr-3":"ml-3"} flex-1 min-w-0`,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:t.customerName}),e.jsxs("p",{className:"text-sm text-gray-500 truncate",children:[t.invoiceNumber," • ",a.frequency[t.frequency]]})]})]})}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${E(t.status)} ${_(t.status)}`,children:a.status[t.status]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500 block",children:[a.installmentInfo.totalAmount,":"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[m(t.totalAmount)," ",a.currency]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500 block",children:[a.installmentInfo.installmentAmount,":"]}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[m(t.installmentAmount)," ",a.currency]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500 block",children:[a.installmentInfo.progress,":"]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[t.paidInstallments," / ",t.totalInstallments]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500 block",children:[a.installmentInfo.remainingAmount,":"]}),e.jsxs("span",{className:"font-semibold text-red-600",children:[m(t.remainingAmount)," ",a.currency]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:a.installmentInfo.progress}),e.jsxs("span",{children:[Math.round(o),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${o}%`}})})]}),n&&e.jsx("div",{className:`p-3 rounded-lg border mb-4 ${n.status==="overdue"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:`text-sm font-medium ${n.status==="overdue"?"text-red-700":"text-yellow-700"}`,children:[a.installmentInfo.nextDue,": ",n.dueDate]}),e.jsxs("span",{className:`block text-sm ${n.status==="overdue"?"text-red-600":"text-yellow-600"}`,children:[m(n.amount)," ",a.currency]}),n.status==="overdue"&&e.jsxs("span",{className:"text-red-700 text-xs",children:["🚨 متأخر ",ee(n.dueDate)," ",a.daysOverdue]})]}),e.jsx("button",{onClick:()=>{T(t),I(n),b({amount:n.amount-(n.paidAmount||0),method:"نقدي",notes:""}),v(!0)},className:`px-3 py-1 rounded text-white text-sm font-medium ${n.status==="overdue"?"bg-red-600 hover:bg-red-700":"bg-yellow-600 hover:bg-yellow-700"} transition-colors`,children:a.actions.pay})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>{T({installment:t,scheduleItem:null}),$(!0)},className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition-colors",children:a.actions.view})})]},t.id)})})}),Q&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.schedule.title}),e.jsx("button",{onClick:()=>$(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:h.installment.customerName}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[a.installmentInfo.totalAmount,":"]}),e.jsxs("span",{className:"font-semibold text-gray-900 mr-1",children:[m(h.installment.totalAmount)," ",a.currency]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[a.installmentInfo.installmentAmount,":"]}),e.jsxs("span",{className:"font-semibold text-blue-600 mr-1",children:[m(h.installment.installmentAmount)," ",a.currency]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[a.installmentInfo.frequency,":"]}),e.jsx("span",{className:"font-semibold text-gray-900 mr-1",children:a.frequency[h.installment.frequency]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.schedule.installmentNumber}),e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.schedule.dueDate}),e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.schedule.amount}),e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.schedule.status}),e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.schedule.paidDate}),e.jsx("th",{className:"px-4 py-2 text-left font-medium text-gray-700",children:a.actions.pay})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:h.installment.installmentSchedule.map((t,n)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3 font-medium",children:["#",n+1]}),e.jsx("td",{className:"px-4 py-3",children:t.dueDate}),e.jsxs("td",{className:"px-4 py-3",children:[m(t.amount)," ",a.currency]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${E(t.status)} ${_(t.status)}`,children:a.status[t.status]})}),e.jsx("td",{className:"px-4 py-3",children:t.paidDate||"-"}),e.jsx("td",{className:"px-4 py-3",children:t.status==="pending"||t.status==="overdue"?e.jsx("button",{onClick:()=>te(h.installment.id,t.id),className:`px-3 py-1 rounded text-white text-xs font-medium ${t.status==="overdue"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"} transition-colors`,children:a.actions.pay}):e.jsx("span",{className:"text-green-600 text-xs",children:"✅"})})]},t.id))})]})})]})})}),U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.create.title}),e.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.create.customer," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:O,onChange:t=>{B(t.target.value),L(!0)},onFocus:()=>L(!0),placeholder:a.create.customerSearch,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),X&&z.length>0&&e.jsx("div",{className:"absolute z-10 w-full bg-white border border-gray-300 rounded-lg mt-1 shadow-lg max-h-40 overflow-y-auto",children:z.map(t=>e.jsxs("div",{onClick:()=>ne(t),className:"px-3 py-2 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.phone})]},t.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.create.totalAmount," *"]}),e.jsx("input",{type:"number",value:s.totalAmount,onChange:t=>u({...s,totalAmount:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.downPayment}),e.jsx("input",{type:"number",value:s.downPayment,onChange:t=>u({...s,downPayment:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),s.totalAmount>0&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:e.jsxs("span",{className:"text-blue-700 text-sm font-medium",children:[a.create.remainingAmount,": ",m(s.totalAmount-s.downPayment)," ",a.currency]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.calculationMethod}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"calculationMethod",value:"by_amount",checked:s.calculationMethod==="by_amount",onChange:t=>u({...s,calculationMethod:t.target.value}),className:"mr-2 text-blue-600"}),e.jsx("span",{className:"text-gray-900",children:a.create.byAmount})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"calculationMethod",value:"by_duration",checked:s.calculationMethod==="by_duration",onChange:t=>u({...s,calculationMethod:t.target.value}),className:"mr-2 text-blue-600"}),e.jsx("span",{className:"text-gray-900",children:a.create.byDuration})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.frequency}),e.jsxs("select",{value:s.frequency,onChange:t=>u({...s,frequency:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"monthly",children:a.frequency.monthly}),e.jsx("option",{value:"biweekly",children:a.frequency.biweekly}),e.jsx("option",{value:"weekly",children:a.frequency.weekly})]})]}),s.calculationMethod==="by_amount"?e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.create.installmentAmount," *"]}),e.jsx("input",{type:"number",value:s.installmentAmount,onChange:t=>u({...s,installmentAmount:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.totalInstallments}),e.jsx("input",{type:"number",value:s.totalInstallments,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.create.duration," *"]}),e.jsx("input",{type:"number",value:s.duration,onChange:t=>u({...s,duration:parseInt(t.target.value)||1}),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),e.jsx("small",{className:"text-gray-500",children:s.frequency==="monthly"?a.create.months:a.create.weeks})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.installmentAmount}),e.jsx("input",{type:"number",value:s.installmentAmount,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.create.startDate," *"]}),e.jsx("input",{type:"date",value:s.startDate,onChange:t=>u({...s,startDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.invoiceNumber}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:s.invoiceNumber,onChange:t=>u({...s,invoiceNumber:t.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{type:"button",onClick:()=>u({...s,invoiceNumber:le()}),className:"px-3 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm",children:a.create.autoGenerate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.create.notes}),e.jsx("textarea",{value:s.notes,onChange:t=>u({...s,notes:t.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{A(!1)},className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:a.create.save}),e.jsx("button",{type:"button",onClick:()=>A(!1),className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:a.create.cancel})]})]})]})})}),Z&&h&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.payment.title}),e.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["العميل: ",e.jsx("span",{className:"font-semibold",children:h.customerName})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["تاريخ الاستحقاق: ",e.jsx("span",{className:"font-semibold",children:l.dueDate})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.payment.dueAmount,":",e.jsxs("span",{className:"font-semibold text-blue-600",children:[m(l.amount-(l.paidAmount||0))," ",a.currency]})]}),l.paidAmount>0&&e.jsxs("p",{className:"text-sm text-gray-600",children:["مدفوع مسبقاً:",e.jsxs("span",{className:"font-semibold text-green-600",children:[m(l.paidAmount)," ",a.currency]})]})]}),i.amount>l.amount-(l.paidAmount||0)&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("p",{className:"text-blue-700 text-sm",children:["💡 ",a.payment.overpayment,": ",m(i.amount-(l.amount-(l.paidAmount||0)))," ",a.currency]}),e.jsx("p",{className:"text-blue-600 text-xs mt-1",children:a.payment.willDistribute})]}),i.amount<l.amount-(l.paidAmount||0)&&i.amount>0&&e.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[e.jsxs("p",{className:"text-yellow-700 text-sm",children:["⚠️ ",a.payment.partialPayment]}),e.jsxs("p",{className:"text-yellow-600 text-xs mt-1",children:[a.payment.remainingForThisInstallment,": ",m(l.amount-(l.paidAmount||0)-i.amount)," ",a.currency]})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.payment.amount," *"]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsxs("button",{type:"button",onClick:()=>b({...i,amount:l.amount-(l.paidAmount||0)}),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors",children:["المبلغ كاملاً (",m(l.amount-(l.paidAmount||0))," ",a.currency,")"]}),l.amount-(l.paidAmount||0)>=1e4&&e.jsxs("button",{type:"button",onClick:()=>b({...i,amount:(l.amount-(l.paidAmount||0))/2}),className:"px-3 py-1 text-xs bg-yellow-100 text-yellow-700 rounded-full hover:bg-yellow-200 transition-colors",children:["نصف المبلغ (",m((l.amount-(l.paidAmount||0))/2)," ",a.currency,")"]})]}),e.jsx("input",{type:"number",value:i.amount,onChange:t=>b({...i,amount:parseFloat(t.target.value)||0}),min:"0",step:"1000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.payment.method}),e.jsxs("select",{value:i.method,onChange:t=>b({...i,method:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"نقدي",children:"نقدي"}),e.jsx("option",{value:"تحويل بنكي",children:"تحويل بنكي"}),e.jsx("option",{value:"بطاقة ائتمان",children:"بطاقة ائتمان"}),e.jsx("option",{value:"شيك",children:"شيك"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a.payment.notes}),e.jsx("textarea",{value:i.notes,onChange:t=>b({...i,notes:t.target.value}),rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors",children:a.payment.save}),e.jsx("button",{type:"button",onClick:()=>{v(!1),I(null)},className:"flex-1 bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:a.payment.cancel})]})]})]})})})]})};export{xe as default};
